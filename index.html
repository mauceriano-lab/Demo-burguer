<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Demo Pedido WhatsApp</title>
<script src="https://cdn.tailwindcss.com"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

<style>
:root {
  --color: #000;
}
.btn { background: var(--color); color:white; }
</style>
</head>

<body class="bg-gray-50 pb-24">

<script>
// ================= CONFIGURACIÓN =================
const WHATSAPP = "34614154983";
const PEDIDO_MINIMO = 15;
const HORARIO = { abre: 19, cierra: 23 }; // 24h

const PRODUCTOS = [
  {
    cat:"Hamburguesas",
    nombre:"Clásica",
    precio:10.5,
    img:"https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=500",
    desc:"Vacuno, queso, lechuga y tomate",
    variantes:{
      "Punto de carne":["Al punto","Muy hecha"]
    }
  },
  {
    cat:"Hamburguesas",
    nombre:"Bacon Cheese",
    precio:12.5,
    img:"https://images.unsplash.com/photo-1553979459-d2229ba7143b?w=500",
    desc:"Doble cheddar y bacon",
    variantes:{
      "Punto de carne":["Al punto","Muy hecha"]
    }
  },
  {
    cat:"Entrantes",
    nombre:"Patatas",
    precio:4.5,
    img:"https://images.unsplash.com/photo-1573015084185-7205ba3d6f2e?w=500",
    desc:"Corte casero"
  }
];
// ===============================================

let carrito = [];
let seleccion = {};
let catActual = "Hamburguesas";

function abierto(){
  const h = new Date().getHours();
  return h >= HORARIO.abre && h < HORARIO.cierra;
}

function renderProductos(){
  const grid = document.getElementById("grid");
  grid.innerHTML = PRODUCTOS
    .filter(p=>p.cat===catActual)
    .map(p=>`
    <div onclick="abrirModal('${p.nombre}')" class="bg-white rounded-2xl p-3 shadow cursor-pointer">
      <img src="${p.img}" class="rounded-xl aspect-square object-cover mb-2">
      <h3 class="font-black text-sm">${p.nombre}</h3>
      <p class="font-bold">${p.precio.toFixed(2)}€</p>
    </div>`).join("");
}

function abrirModal(nombre){
  const p = PRODUCTOS.find(x=>x.nombre===nombre);
  seleccion = {};
  document.getElementById("m-nombre").innerText = p.nombre;
  document.getElementById("m-img").src = p.img;
  document.getElementById("m-desc").innerText = p.desc;
  document.getElementById("m-precio").innerText = p.precio.toFixed(2)+"€";

  const cont = document.getElementById("m-var");
  cont.innerHTML="";
  if(p.variantes){
    Object.keys(p.variantes).forEach(k=>{
      cont.innerHTML+=`
      <div>
        <p class="text-xs font-bold text-gray-400">${k}</p>
        <div class="flex gap-2 mt-1">
          ${p.variantes[k].map(v=>`
            <button onclick="selVar('${k}','${v}',this)"
            class="border px-3 py-2 rounded-xl text-xs font-bold">${v}</button>
          `).join("")}
        </div>
      </div>`;
    });
  }

  document.getElementById("add").onclick=()=>{
    carrito.push({p,cantidad:1,vars:{...seleccion}});
    cerrarModal();
    renderCarrito();
  };
  document.getElementById("modal").classList.remove("hidden");
}

function selVar(k,v,b){
  seleccion[k]=v;
  [...b.parentNode.children].forEach(x=>x.classList.remove("bg-black","text-white"));
  b.classList.add("bg-black","text-white");
}

function cerrarModal(){ document.getElementById("modal").classList.add("hidden"); }

function renderCarrito(){
  const cont = document.getElementById("carrito");
  let total=0;
  cont.innerHTML=carrito.map((i,idx)=>{
    total+=i.p.precio*i.cantidad;
    return`
    <div class="bg-gray-100 p-3 rounded-xl text-xs font-bold flex justify-between items-center">
      <div>
        ${i.p.nombre}<br>
        <small>${Object.values(i.vars).join(" / ")}</small>
      </div>
      <div class="flex items-center gap-2">
        <button onclick="cambiar(${idx},-1)">➖</button>
        ${i.cantidad}
        <button onclick="cambiar(${idx},1)">➕</button>
        <button onclick="eliminar(${idx})">❌</button>
      </div>
    </div>`;
  }).join("");

  document.getElementById("total").innerText = total.toFixed(2)+"€";
}

function cambiar(i,d){
  carrito[i].cantidad+=d;
  if(carrito[i].cantidad<=0) carrito.splice(i,1);
  renderCarrito();
}
function eliminar(i){ carrito.splice(i,1); renderCarrito(); }

function enviar(){
  if(!abierto()) return alert("Estamos cerrados");
  const modo = document.getElementById("modo").value;
  const nombre = document.getElementById("nombre").value;
  const tel = document.getElementById("tel").value;
  const dir = document.getElementById("dir").value;

  if(!nombre || !tel) return alert("Faltan datos");
  if(modo==="Domicilio" && !dir) return alert("Falta dirección");

  let total=0;
  let lista="";
  carrito.forEach(i=>{
    total+=i.p.precio*i.cantidad;
    lista+=`• ${i.cantidad}x ${i.p.nombre} (${i.p.precio}€)%0A`;
  });

  if(total < PEDIDO_MINIMO) return alert("Pedido mínimo "+PEDIDO_MINIMO+"€");

  const msg=`Pedido:%0A${lista}%0ATotal: ${total.toFixed(2)}€`;
  window.open(`https://wa.me/${WHATSAPP}?text=${msg}`);
}

</script>

<header class="bg-white p-4 font-black text-center">DEMO PEDIDOS</header>

<div class="flex gap-2 p-3">
<button onclick="catActual='Hamburguesas';renderProductos()">Hamburguesas</button>
<button onclick="catActual='Entrantes';renderProductos()">Entrantes</button>
</div>

<main id="grid" class="grid grid-cols-2 gap-4 p-4"></main>

<section class="fixed bottom-0 w-full bg-white p-4 border-t">
<div id="carrito" class="space-y-2"></div>
<p class="font-black mt-2">Total: <span id="total">0€</span></p>

<select id="modo" class="w-full p-2 mt-2">
<option>Domicilio</option>
<option>Recoger</option>
</select>

<input id="nombre" placeholder="Nombre" class="w-full p-2 mt-2">
<input id="tel" placeholder="Teléfono" class="w-full p-2 mt-2">
<input id="dir" placeholder="Dirección" class="w-full p-2 mt-2">

<button onclick="enviar()" class="btn w-full p-4 mt-3 font-black">
HACER PEDIDO
</button>
</section>

<div id="modal" class="fixed inset-0 bg-black/60 hidden flex items-end">
<div class="bg-white w-full p-6 rounded-t-3xl">
<h3 id="m-nombre" class="font-black text-xl"></h3>
<img id="m-img" class="rounded-2xl my-3">
<p id="m-desc"></p>
<div id="m-var" class="space-y-4 mt-4"></div>
<div class="flex justify-between mt-4">
<span id="m-precio" class="font-black"></span>
<button id="add" class="btn px-6 py-3 rounded-xl">Añadir</button>
</div>
</div>
</div>

<script>renderProductos()</script>
</body>
</html>
