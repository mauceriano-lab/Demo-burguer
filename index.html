<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Tienda Demo | Pedido por WhatsApp</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    :root { --btn: #000000; --txt: #000000; --bg: #f9fafb; }
    body { background-color: var(--bg); color: var(--txt); font-family: system-ui, -apple-system, sans-serif; }
    .btn-principal { background-color: var(--btn) !important; color: white; }
    .modal-animate { animation: slideUp 0.3s ease-out; }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    .no-scrollbar::-webkit-scrollbar { display: none; }
  </style>
</head>

<body class="pb-20">

<header class="bg-white sticky top-0 z-40 border-b shadow-sm">
  <div class="max-w-md mx-auto px-5 py-4 flex justify-between items-center">
    <h1 class="text-xl font-black italic tracking-tighter uppercase">TIENDA DEMO üõçÔ∏è</h1>
    <button onclick="toggleCart()" class="relative p-2 bg-gray-100 rounded-full">
      <i class="fa-solid fa-shopping-bag text-xl"></i>
      <span id="cart-count" class="absolute -top-1 -right-1 bg-red-600 text-white text-[10px] font-bold rounded-full h-5 w-5 flex items-center justify-center">0</span>
    </button>
  </div>

  <div class="max-w-md mx-auto px-5 py-3 flex gap-2 overflow-x-auto no-scrollbar border-t bg-white">
    <button onclick="filterCat('Ropa')" class="cat-btn bg-black text-white px-5 py-2 rounded-full text-xs font-bold shrink-0">Ropa</button>
    <button onclick="filterCat('Belleza')" class="cat-btn bg-gray-100 text-black px-5 py-2 rounded-full text-xs font-bold shrink-0">Belleza</button>
    <button onclick="filterCat('Hogar')" class="cat-btn bg-gray-100 text-black px-5 py-2 rounded-full text-xs font-bold shrink-0">Hogar</button>
    <button onclick="filterCat('Accesorios')" class="cat-btn bg-gray-100 text-black px-5 py-2 rounded-full text-xs font-bold shrink-0">Accesorios</button>
  </div>
</header>

<main class="max-w-md mx-auto px-5 py-6">
  <div class="mb-4 relative">
    <i class="fa-solid fa-magnifying-glass absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 text-sm"></i>
    <input id="search" oninput="applySearch()" placeholder="Buscar productos..."
           class="w-full pl-9 pr-3 py-3 bg-white border rounded-2xl text-sm font-semibold shadow-sm">
  </div>

  <div id="product-grid" class="grid grid-cols-2 gap-4"></div>
</main>

<!-- Product modal -->
<div id="product-modal" class="fixed inset-0 bg-black/60 z-[60] hidden flex items-end sm:items-center justify-center backdrop-blur-sm">
  <div class="bg-white w-full max-w-md rounded-t-[2.5rem] sm:rounded-[2.5rem] p-6 max-h-[90vh] overflow-y-auto modal-animate">
    <div class="flex justify-between items-center mb-4">
      <h3 id="modal-p-nombre" class="text-xl font-black uppercase"></h3>
      <button onclick="closeProductModal()" class="text-3xl text-gray-300">&times;</button>
    </div>
    <img id="modal-p-img" src="" class="w-full aspect-square object-cover rounded-[2rem] mb-4 shadow-md">
    <p id="modal-p-desc" class="text-gray-500 text-sm mb-6"></p>

    <div id="variantes-container" class="space-y-6 mb-8"></div>

    <div class="flex items-center justify-between gap-4 sticky bottom-0 bg-white pt-3 border-t">
      <span id="modal-p-precio" class="text-2xl font-black"></span>
      <button id="add-from-modal" class="flex-grow btn-principal py-4 rounded-2xl font-bold uppercase text-xs tracking-widest">A√±adir</button>
    </div>
  </div>
</div>

<!-- Cart modal -->
<div id="cart-modal" class="fixed inset-0 bg-black/50 z-[70] hidden backdrop-blur-sm">
  <div class="bg-white w-full max-w-sm h-full ml-auto flex flex-col p-6 shadow-2xl overflow-y-auto">
    <div class="flex justify-between items-center border-b pb-4 mb-4">
      <h2 class="text-xl font-black uppercase">Tu Carrito</h2>
      <button onclick="toggleCart()" class="text-3xl text-gray-300">&times;</button>
    </div>

    <div id="cart-items" class="space-y-3 mb-6"></div>

    <!-- SOLO datos del cliente -->
    <div class="space-y-4 border-t pt-4">
      <textarea id="cust-notes" placeholder="Notas (talla, color, alergias...)" class="w-full p-3 bg-gray-50 border rounded-xl text-sm h-16" oninput="saveState()"></textarea>
      <input type="text" id="cust-name" placeholder="Tu Nombre" class="w-full p-3 bg-gray-50 border rounded-xl text-sm" oninput="saveState()">
      <input type="tel" id="cust-phone" placeholder="Tu Tel√©fono" class="w-full p-3 bg-gray-50 border rounded-xl text-sm" oninput="saveState()">
      <input type="text" id="cust-address" placeholder="Direcci√≥n completa" class="w-full p-3 bg-gray-50 border rounded-xl text-sm" oninput="saveState()">

      <div class="flex justify-between text-2xl font-black pt-2">
        <span>TOTAL:</span>
        <span id="total-val">0.00‚Ç¨</span>
      </div>

      <div class="flex gap-2">
        <button onclick="vaciarCarrito()" class="w-full py-4 rounded-2xl font-black text-xs uppercase border bg-gray-50">
          Vaciar
        </button>
        <button onclick="enviarPedido()" class="w-full btn-principal py-4 rounded-2xl font-black text-xs uppercase flex items-center justify-center gap-2">
          <i class="fa-brands fa-whatsapp text-xl"></i> Enviar pedido
        </button>
      </div>

      <p class="text-[11px] text-gray-500 font-semibold mt-1">
        El pedido se env√≠a por WhatsApp y el vendedor te comparte el enlace de pago.
      </p>
    </div>
  </div>
</div>

<script>
  /** CONFIG */
  const WHATSAPP_VENDEDOR = "34633817413"; // +34 633 817 413 (wa.me sin "+")
  const MONEDA = "‚Ç¨";
  const LS_KEY = "demo_store_clean_v1";

  /** PRODUCTOS (4 categor√≠as, 6 c/u) */
  const PRODUCTOS = [
    // Ropa (6)
    { id:"ropa-1", cat:"Ropa", nombre:"Playera B√°sica Algod√≥n", precio:12.90, desc:"Algod√≥n suave, corte unisex. Ideal para diario.", img:"https://images.unsplash.com/photo-1520975661595-6453be3f7070?w=500", Talla:"S, M, L, XL", Color:"Negro, Blanco, Gris" },
    { id:"ropa-2", cat:"Ropa", nombre:"Sudadera Oversize", precio:29.90, desc:"Interior afelpado, estilo urbano.", img:"https://images.unsplash.com/photo-1520975958225-ff7f128a02e9?w=500", Talla:"S, M, L, XL", Color:"Negro, Arena" },
    { id:"ropa-3", cat:"Ropa", nombre:"Gorra Bordada", precio:14.50, desc:"Ajustable, bordado frontal.", img:"https://images.unsplash.com/photo-1520975687960-5f5b89a1cdd6?w=500", Color:"Negro, Beige, Azul" },
    { id:"ropa-4", cat:"Ropa", nombre:"Calcetas Deportivas (Pack x3)", precio:9.90, desc:"Transpirables, soporte en arco.", img:"https://images.unsplash.com/photo-1582738412142-75b1a36c5c2d?w=500", Talla:"CH, M, G" },
    { id:"ropa-5", cat:"Ropa", nombre:"Tote Bag Resistente", precio:11.00, desc:"Lona gruesa, ideal para mandado.", img:"https://images.unsplash.com/photo-1520975680963-9b3cbb6f0a77?w=500", Color:"Natural, Negro" },
    { id:"ropa-6", cat:"Ropa", nombre:"Rompevientos Ligero", precio:34.90, desc:"Ligero y c√≥modo, para clima variable.", img:"https://images.unsplash.com/photo-1520975749810-05e25f4c7d11?w=500", Talla:"S, M, L, XL" },

    // Belleza (6)
    { id:"bel-1", cat:"Belleza", nombre:"B√°lsamo Labial", precio:4.50, desc:"Hidrataci√≥n diaria, aroma suave.", img:"https://images.unsplash.com/photo-1612810436541-336d7c0f7fd6?w=500", Sabor:"Vainilla, Menta, Coco" },
    { id:"bel-2", cat:"Belleza", nombre:"Crema de Manos", precio:6.90, desc:"R√°pida absorci√≥n, no grasosa.", img:"https://images.unsplash.com/photo-1585232351009-aa87416fca90?w=500", Sabor:"Karit√©, Almendra" },
    { id:"bel-3", cat:"Belleza", nombre:"Jab√≥n Artesanal", precio:5.20, desc:"Hecho a mano. Suave con la piel.", img:"https://images.unsplash.com/photo-1607006344380-b6775a0824ce?w=500", Tipo:"Avena, Lavanda, Carb√≥n" },
    { id:"bel-4", cat:"Belleza", nombre:"Perfume Roll-on 10ml", precio:9.90, desc:"Fragancia pr√°ctica para bolsa.", img:"https://images.unsplash.com/photo-1547887537-6158d64c35b3?w=500", Modelo:"Dulce, Fresco, Amaderado" },
    { id:"bel-5", cat:"Belleza", nombre:"Serum Vitamina C", precio:16.90, desc:"Ilumina y unifica (uso diario).", img:"https://images.unsplash.com/photo-1611930022073-84fbbd9f19b1?w=500", Tipo:"Suave, Concentrado" },
    { id:"bel-6", cat:"Belleza", nombre:"Kit Skincare (Mini)", precio:18.00, desc:"Limpieza + hidrataci√≥n (tama√±o viaje).", img:"https://images.unsplash.com/photo-1556228578-0d85b1a4d571?w=500", Tipo:"Piel seca, Piel mixta, Piel grasa" },

    // Hogar (6)
    { id:"hog-1", cat:"Hogar", nombre:"Vela Arom√°tica", precio:11.50, desc:"Aroma c√°lido, envase de vidrio.", img:"https://images.unsplash.com/photo-1602874801007-8a3b3d5f13d8?w=500", Sabor:"Vainilla, Canela, Lavanda" },
    { id:"hog-2", cat:"Hogar", nombre:"Difusor de Varillas", precio:15.90, desc:"Aroma constante en tu espacio.", img:"https://images.unsplash.com/photo-1602874801085-21c95b6f7b67?w=500", Sabor:"C√≠trico, Floral" },
    { id:"hog-3", cat:"Hogar", nombre:"Taza Cer√°mica 330ml", precio:8.20, desc:"Apta microondas. Minimalista.", img:"https://images.unsplash.com/photo-1517705008128-361805f42e86?w=500", Color:"Blanco, Negro" },
    { id:"hog-4", cat:"Hogar", nombre:"Botella T√©rmica 500ml", precio:19.90, desc:"Acero inoxidable. Fr√≠o/calor.", img:"https://images.unsplash.com/photo-1526401485004-2aa7c9f53c62?w=500", Color:"Negro, Plateado" },
    { id:"hog-5", cat:"Hogar", nombre:"Organizador Escritorio", precio:12.90, desc:"Ordena cables, notas y accesorios.", img:"https://images.unsplash.com/photo-1586075010923-2dd4570fb338?w=500", Material:"Madera, Metal" },
    { id:"hog-6", cat:"Hogar", nombre:"Set Toallas (2 piezas)", precio:21.00, desc:"Suaves y absorbentes.", img:"https://images.unsplash.com/photo-1582582621959-48d27397dc5c?w=500", Color:"Blanco, Gris" },

    // Accesorios (6)
    { id:"acc-1", cat:"Accesorios", nombre:"Cargador USB-C 20W", precio:14.90, desc:"Carga r√°pida compatible.", img:"https://images.unsplash.com/photo-1583863788434-e58a36330cf0?w=500", Modelo:"EU, US" },
    { id:"acc-2", cat:"Accesorios", nombre:"Cable Trenzado 1.5m", precio:7.90, desc:"Resistente, ideal uso diario.", img:"https://images.unsplash.com/photo-1583863788435-4a8f8d6b7a6b?w=500", Tipo:"USB-C, Lightning" },
    { id:"acc-3", cat:"Accesorios", nombre:"Aud√≠fonos In-ear", precio:18.90, desc:"Buen audio para llamadas y m√∫sica.", img:"https://images.unsplash.com/photo-1585386959984-a41552231693?w=500", Color:"Negro, Blanco" },
    { id:"acc-4", cat:"Accesorios", nombre:"Soporte de Celular", precio:9.50, desc:"Para escritorio o cocina. Ajustable.", img:"https://images.unsplash.com/photo-1512499617640-c2f999fe2a5d?w=500", Tipo:"Metal, Pl√°stico" },
    { id:"acc-5", cat:"Accesorios", nombre:"Power Bank 10,000mAh", precio:24.90, desc:"Compacta, carga dos dispositivos.", img:"https://images.unsplash.com/photo-1602524205579-8a3f997e98c3?w=500", Modelo:"Negro, Azul" },
    { id:"acc-6", cat:"Accesorios", nombre:"Llavero Minimal", precio:4.20, desc:"Ligero y elegante.", img:"https://images.unsplash.com/photo-1520975681324-3b8f9e8b8d50?w=500", Material:"Acero, Cuero" },
  ];

  /** STATE */
  let carrito = [];         // [{k,id,n,p,o,qty}]
  let seleccionActual = {}; // variantes del modal
  let categoriaActual = "Ropa";
  let busqueda = "";
  let pickQty = {};         // cantidad elegida por tarjeta: { [id]: number }

  /** Utils */
  function money(x){ return x.toFixed(2) + MONEDA; }
  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
  function escapeAttr(s){ return escapeHtml(s).replace(/`/g,'&#96;'); }
  function keyOf(id, o){
    const opts = Object.entries(o||{}).sort(([a],[b]) => a.localeCompare(b));
    return id + "||" + JSON.stringify(opts);
  }

  /** Persistence */
  function saveState(){
    const payload = {
      carrito,
      ui: { categoriaActual, busqueda, pickQty },
      form: {
        notes: document.getElementById('cust-notes').value,
        name: document.getElementById('cust-name').value,
        phone: document.getElementById('cust-phone').value,
        address: document.getElementById('cust-address').value
      }
    };
    localStorage.setItem(LS_KEY, JSON.stringify(payload));
  }

  function loadState(){
    try{
      const s = JSON.parse(localStorage.getItem(LS_KEY));
      if(s?.carrito) carrito = s.carrito;
      if(s?.ui){
        categoriaActual = s.ui.categoriaActual || categoriaActual;
        busqueda = s.ui.busqueda || "";
        pickQty = s.ui.pickQty || {};
        document.getElementById("search").value = busqueda;
      }
      if(s?.form){
        document.getElementById('cust-notes').value = s.form.notes || "";
        document.getElementById('cust-name').value = s.form.name || "";
        document.getElementById('cust-phone').value = s.form.phone || "";
        document.getElementById('cust-address').value = s.form.address || "";
      }
    }catch(e){}
  }

  /** Category */
  function setActiveCatBtn(cat){
    document.querySelectorAll('.cat-btn').forEach(b => {
      b.classList.remove('bg-black','text-white');
      b.classList.add('bg-gray-100','text-black');
      if(b.innerText === cat){
        b.classList.add('bg-black','text-white');
        b.classList.remove('bg-gray-100');
      }
    });
  }

  function filterCat(cat){
    categoriaActual = cat;
    setActiveCatBtn(cat);
    saveState();
    renderGrid();
  }

  function applySearch(){
    busqueda = (document.getElementById("search").value || "").trim().toLowerCase();
    saveState();
    renderGrid();
  }

  /** Quantity selector in each product card */
  function getPick(id){ return Math.max(1, Number(pickQty[id] || 1)); }
  function incPick(id){ pickQty[id] = getPick(id) + 1; saveState(); renderGrid(); }
  function decPick(id){ pickQty[id] = Math.max(1, getPick(id) - 1); saveState(); renderGrid(); }

  function addFromCard(id){
    const p = PRODUCTOS.find(x => x.id === id);
    if(!p) return;
    const qty = getPick(id);
    addToCart(p.id, p.nombre, p.precio, {}, qty); // sin variantes desde tarjeta
  }

  /** Grid */
  function renderGrid(){
    const grid = document.getElementById('product-grid');
    const list = PRODUCTOS
      .filter(p => p.cat === categoriaActual)
      .filter(p => {
        if(!busqueda) return true;
        const hay = (p.nombre + " " + p.desc + " " + JSON.stringify(p)).toLowerCase();
        return hay.includes(busqueda);
      });

    grid.innerHTML = list.map(p => {
      const q = getPick(p.id);
      return `
        <div class="bg-white rounded-[2rem] p-3 border border-gray-100 flex flex-col shadow-sm transition-all">
          <button type="button" onclick="openModal('${escapeAttr(p.id)}')" class="text-left active:scale-[0.99] transition-all">
            <img src="${p.img}" class="w-full aspect-square object-cover rounded-[1.5rem] mb-2" onerror="this.src='https://picsum.photos/seed/${encodeURIComponent(p.nombre)}/600/600'">
            <h3 class="text-xs font-black uppercase tracking-tighter">${escapeHtml(p.nombre)}</h3>
            <p class="font-bold text-sm mt-1 text-black">${money(p.precio)}</p>
          </button>

          <div class="mt-3 flex items-center justify-between gap-2">
            <div class="flex items-center gap-2">
              <button type="button" onclick="decPick('${escapeAttr(p.id)}')" class="px-3 py-2 rounded-xl border bg-white font-black">‚àí</button>
              <span class="px-3 py-2 rounded-xl border bg-gray-50 font-black min-w-[44px] text-center">${q}</span>
              <button type="button" onclick="incPick('${escapeAttr(p.id)}')" class="px-3 py-2 rounded-xl border bg-white font-black">+</button>
            </div>
            <button type="button" onclick="addFromCard('${escapeAttr(p.id)}')" class="btn-principal px-4 py-2 rounded-xl font-black text-[10px] uppercase tracking-widest">
              A√±adir
            </button>
          </div>
        </div>
      `;
    }).join('') || `<div class="col-span-2 text-sm font-bold text-gray-500 bg-white border rounded-2xl p-4">No hay resultados.</div>`;
  }

  /** Modal */
  function openModal(id) {
    const p = PRODUCTOS.find(prod => prod.id === id);
    if(!p) return;
    seleccionActual = {};

    document.getElementById('modal-p-nombre').innerText = p.nombre;
    document.getElementById('modal-p-img').src = p.img;
    document.getElementById('modal-p-desc').innerText = p.desc;
    document.getElementById('modal-p-precio').innerText = money(p.precio);

    const cont = document.getElementById('variantes-container');
    cont.innerHTML = "";

    ['Talla', 'Color', 'Material', 'Sabor', 'Modelo', 'Tipo'].forEach(key => {
      if(p[key]) {
        const opciones = String(p[key]).split(',').map(o => o.trim()).filter(Boolean);
        cont.innerHTML += `
          <div>
            <label class="text-[10px] font-bold text-gray-400 block mb-2 uppercase">${escapeHtml(key)}</label>
            <div class="flex gap-2 flex-wrap" id="g-${key}">
              ${opciones.map(o => `
                <button type="button" onclick="sel(this, '${key}', '${escapeAttr(o)}')" class="border-2 px-4 py-2 rounded-xl text-xs font-bold">
                  ${escapeHtml(o)}
                </button>
              `).join('')}
            </div>
          </div>
        `;
      }
    });

    document.getElementById('add-from-modal').onclick = () => {
      // Desde modal: a√±ade 1 unidad con variantes
      addToCart(p.id, p.nombre, p.precio, {...seleccionActual}, 1);
      closeProductModal();
    };

    document.getElementById('product-modal').classList.remove('hidden');
  }

  function sel(btn, k, v) {
    document.querySelectorAll(`#g-${k} button`).forEach(b => b.classList.remove('bg-black', 'text-white', 'border-black'));
    btn.classList.add('bg-black', 'text-white', 'border-black');
    seleccionActual[k] = v;
  }

  function closeProductModal() { document.getElementById('product-modal').classList.add('hidden'); }
  function toggleCart() { document.getElementById('cart-modal').classList.toggle('hidden'); }

  /** Cart */
  function addToCart(id, n, p, o, qty){
    const k = keyOf(id, o);
    const found = carrito.find(x => x.k === k);
    if(found) found.qty += qty;
    else carrito.push({ k, id, n, p, o, qty });
    saveState();
    updateCart();
  }

  function incItem(k){
    const it = carrito.find(x => x.k === k);
    if(!it) return;
    it.qty += 1;
    saveState();
    updateCart();
  }

  function decItem(k){
    const it = carrito.find(x => x.k === k);
    if(!it) return;
    it.qty -= 1;
    if(it.qty <= 0) carrito = carrito.filter(x => x.k !== k);
    saveState();
    updateCart();
  }

  function removeItem(k){
    carrito = carrito.filter(x => x.k !== k);
    saveState();
    updateCart();
  }

  function vaciarCarrito(){
    if(!confirm("¬øVaciar carrito?")) return;
    carrito = [];
    saveState();
    updateCart();
  }

  function updateCart() {
    const count = carrito.reduce((s,x)=>s+x.qty,0);
    document.getElementById('cart-count').innerText = count;

    let total = 0;
    document.getElementById('cart-items').innerHTML = carrito.map(it => {
      const variantes = Object.values(it.o||{}).join(' / ') || 'Sin variantes';
      const lineTotal = it.p * it.qty;
      total += lineTotal;

      return `
        <div class="bg-gray-50 p-3 rounded-2xl text-xs font-bold">
          <div class="flex justify-between gap-3">
            <div>
              <span>${escapeHtml(it.n)}</span><br>
              <small class="text-gray-400">${escapeHtml(variantes)}</small>
            </div>
            <div class="text-right whitespace-nowrap">
              <div>${money(lineTotal)}</div>
              <div class="text-[10px] text-gray-400 font-black">${money(it.p)} c/u</div>
            </div>
          </div>

          <div class="mt-3 flex items-center justify-between gap-2">
            <div class="flex items-center gap-2">
              <button type="button" onclick="decItem('${escapeAttr(it.k)}')" class="px-3 py-2 rounded-xl border bg-white font-black">‚àí</button>
              <span class="px-3 py-2 rounded-xl border bg-white font-black">${it.qty}</span>
              <button type="button" onclick="incItem('${escapeAttr(it.k)}')" class="px-3 py-2 rounded-xl border bg-white font-black">+</button>
            </div>
            <button type="button" onclick="removeItem('${escapeAttr(it.k)}')" class="px-3 py-2 rounded-xl border bg-white font-black text-red-600">
              <i class="fa-solid fa-trash"></i>
            </button>
          </div>
        </div>
      `;
    }).join('') || `
      <div class="bg-gray-50 p-4 rounded-2xl text-sm font-bold text-gray-500">
        Tu carrito est√° vac√≠o. Agrega productos para poder enviar el pedido.
      </div>
    `;

    document.getElementById('total-val').innerText = money(total);
  }

  /** WhatsApp (SIN lugar/tipo/hora/pago) */
  function enviarPedido() {
    const nombre = (document.getElementById('cust-name').value || "").trim();
    const tlf = (document.getElementById('cust-phone').value || "").trim();
    const addr = (document.getElementById('cust-address').value || "").trim();
    const notas = (document.getElementById('cust-notes').value || "").trim();

    if(carrito.length === 0) return alert("Tu carrito est√° vac√≠o.");
    if(!nombre || nombre.length < 2) return alert("Escribe tu nombre.");
    if(!tlf || tlf.length < 6) return alert("Escribe tu tel√©fono.");
    if(!addr || addr.length < 6) return alert("Escribe tu direcci√≥n completa.");

    let lista = "";
    let total = 0;

    carrito.forEach(it => {
      const variantes = Object.values(it.o||{}).join(' / ') || "Sin variantes";
      const lineTotal = it.p * it.qty;
      total += lineTotal;
      lista += `‚Ä¢ ${it.n} x${it.qty} [${variantes}] (${money(lineTotal)})\n`;
    });

    const msg =
`üì¶ NUEVO PEDIDO
üë§ CLIENTE: ${nombre}
üìû TEL√âFONO: ${tlf}
üìç DIRECCI√ìN: ${addr}
------------------
üõçÔ∏è PEDIDO:
${lista}
üìù NOTAS: ${notas || "Ninguna"}
üí∞ TOTAL: ${money(total)}
------------------
‚úÖ Confirma recepci√≥n y env√≠a enlace de pago.`;

    window.open(`https://wa.me/${WHATSAPP_VENDEDOR}?text=${encodeURIComponent(msg)}`, '_blank', 'noopener,noreferrer');
  }

  /** INIT */
  loadState();
  setActiveCatBtn(categoriaActual);
  renderGrid();
  updateCart();
</script>

</body>
</html>
